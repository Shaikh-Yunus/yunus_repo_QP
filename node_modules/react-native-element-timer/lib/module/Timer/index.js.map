{"version":3,"names":["React","useCallback","useEffect","useImperativeHandle","useRef","useState","View","Text","styles","BackgroundTimer","defaultProps","style","textStyle","onTimes","_seconds","onPause","onEnd","TimerComponent","forwardRef","props","ref","initialSeconds","fontFamily","autoStart","formatTime","interval","hours","minute","seconds","currentSeconds","key","setKey","Math","random","start","pause","resume","stop","timer","current","setInterval","initTime","iSeconds","times","init","clear","clearInterval","font","renderTimer","text","toString","length"],"sources":["index.tsx"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\n/* eslint-disable no-bitwise */\nimport React, {\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from 'react';\nimport { View, Text } from 'react-native';\nimport { styles } from './styles';\nimport type { TimerProps } from './model';\nimport BackgroundTimer from 'react-native-background-timer';\n\nconst defaultProps = {\n  style: {},\n  textStyle: {},\n  onTimes: (_seconds: number) => {},\n  onPause: (_seconds: number) => {},\n  onEnd: (_seconds: number) => {},\n};\n\nconst TimerComponent = React.forwardRef<any, TimerProps>((props, ref) => {\n  const {\n    initialSeconds = 0,\n    style,\n    textStyle,\n    fontFamily,\n    autoStart = false,\n    formatTime = 'hh:mm:ss',\n    onEnd,\n    onTimes,\n    onPause,\n  } = props;\n\n  const interval = useRef(0);\n  const hours = useRef(0);\n  const minute = useRef(0);\n  const seconds = useRef(0);\n  const currentSeconds = useRef(0);\n\n  const [key, setKey] = useState(Math.random());\n\n  useImperativeHandle(ref, () => {\n    return { start, pause, resume, stop };\n  });\n\n  const timer = useCallback(() => {\n    interval.current = BackgroundTimer.setInterval(() => {\n      currentSeconds.current = currentSeconds.current + 1;\n      if (seconds.current < 60) {\n        seconds.current = seconds.current + 1;\n      } else {\n        seconds.current = 0;\n        minute.current = minute.current + 1;\n      }\n      if (minute.current === 60) {\n        minute.current = 0;\n        hours.current = hours.current + 1;\n      }\n      if (onTimes) {\n        onTimes(currentSeconds.current);\n      }\n      setKey(Math.random());\n    }, 1000);\n  }, []);\n\n  const initTime = useCallback((iSeconds: number) => {\n    if (iSeconds >= 3600) {\n      hours.current = ~~(iSeconds / 3600);\n      const times = iSeconds % 3600;\n      initTime(times);\n    } else {\n      if (iSeconds >= 60) {\n        minute.current = ~~(iSeconds / 60);\n        const times = iSeconds % 60;\n        initTime(times);\n      } else {\n        seconds.current = iSeconds;\n      }\n    }\n  }, []);\n\n  const init = useCallback(() => {\n    currentSeconds.current = 0;\n    hours.current = 0;\n    minute.current = 0;\n    seconds.current = 0;\n\n    if (initialSeconds > 0) {\n      initTime(initialSeconds);\n    }\n\n    setKey(Math.random());\n  }, [initialSeconds]);\n\n  const start = useCallback(() => {\n    init();\n\n    if (!interval.current) {\n      timer();\n    }\n  }, []);\n\n  const pause = useCallback(() => {\n    clear();\n    if (onPause) {\n      onPause(currentSeconds.current);\n    }\n  }, []);\n\n  const resume = () => {\n    if (!interval.current) {\n      timer();\n    }\n  };\n\n  const stop = () => {\n    if (onEnd) {\n      onEnd(currentSeconds.current);\n    }\n\n    init();\n    setKey(Math.random());\n    clear();\n  };\n\n  const clear = () => {\n    if (interval.current) {\n      BackgroundTimer.clearInterval(interval.current);\n      interval.current = 0;\n    }\n  };\n\n  useEffect(() => {\n    init();\n  }, [initialSeconds]);\n\n  useEffect(() => {\n    return () => {\n      pause();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (autoStart) {\n      start();\n    }\n  }, [autoStart]);\n\n  const font = () => {\n    if (fontFamily) {\n      return {\n        fontFamily: fontFamily,\n      };\n    } else {\n      return {};\n    }\n  };\n\n  const renderTimer = () => {\n    if (formatTime === 'hh:mm:ss') {\n      if (hours.current > 0) {\n        return (\n          <Text style={[styles.text, textStyle, font()]}>{`${hours.current}:${\n            minute.current.toString().length === 1 ? '0' : ''\n          }${minute.current}:${\n            seconds.current.toString().length === 1 ? '0' : ''\n          }${seconds.current}`}</Text>\n        );\n      } else {\n        if (minute.current > 0) {\n          return (\n            <Text style={[styles.text, textStyle, font()]}>{`${\n              minute.current\n            }:${seconds.current.toString().length === 1 ? '0' : ''}${\n              seconds.current\n            }`}</Text>\n          );\n        } else {\n          return (\n            <Text\n              style={[styles.text, textStyle, font()]}\n            >{`${seconds.current}`}</Text>\n          );\n        }\n      }\n    } else {\n      return (\n        <Text\n          style={[styles.text, textStyle, font()]}\n        >{`${currentSeconds.current}`}</Text>\n      );\n    }\n  };\n\n  return (\n    <View style={style} key={key}>\n      {renderTimer()}\n    </View>\n  );\n});\n\nTimerComponent.defaultProps = defaultProps;\n\nexport default TimerComponent;\n"],"mappings":"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"}