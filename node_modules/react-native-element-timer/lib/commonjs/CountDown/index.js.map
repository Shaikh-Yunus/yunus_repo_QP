{"version":3,"names":["defaultProps","style","textStyle","onTimes","_seconds","onPause","onEnd","CountdownComponent","React","forwardRef","props","ref","initialSeconds","fontFamily","autoStart","formatTime","interval","useRef","hours","minute","seconds","currentSeconds","key","setKey","useState","Math","random","useImperativeHandle","start","pause","resume","stop","init","useCallback","current","clear","timer","useEffect","BackgroundTimer","setInterval","clearInterval","font","renderTimer","styles","text","toString","length"],"sources":["index.tsx"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\n/* eslint-disable no-bitwise */\nimport React, {\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from 'react';\nimport { View, Text } from 'react-native';\nimport { styles } from './styles';\nimport type { CountDownProps } from './model';\nimport BackgroundTimer from 'react-native-background-timer';\n\nconst defaultProps = {\n  style: {},\n  textStyle: {},\n  onTimes: (_seconds: number) => {},\n  onPause: (_seconds: number) => {},\n  onEnd: (_seconds: number) => {},\n};\n\nconst CountdownComponent = React.forwardRef<any, CountDownProps>(\n  (props, ref) => {\n    const {\n      initialSeconds,\n      style,\n      textStyle,\n      fontFamily,\n      autoStart = false,\n      formatTime = 'hh:mm:ss',\n      onEnd,\n      onTimes,\n      onPause,\n    } = props;\n\n    const interval = useRef(0);\n    const hours = useRef(0);\n    const minute = useRef(0);\n    const seconds = useRef(0);\n    const currentSeconds = useRef(0);\n\n    const [key, setKey] = useState(Math.random());\n\n    useImperativeHandle(ref, () => {\n      return { start, pause, resume, stop };\n    });\n\n    const init = useCallback(() => {\n      if (initialSeconds) {\n        currentSeconds.current = initialSeconds;\n        hours.current = ~~(currentSeconds.current / 3600);\n        minute.current = ~~((currentSeconds.current % 3600) / 60);\n        seconds.current = ~~currentSeconds.current % 60;\n      }\n      setKey(Math.random());\n    }, [initialSeconds]);\n\n    const pause = useCallback(() => {\n      if (onPause) {\n        onPause(currentSeconds.current);\n      }\n      clear();\n    }, []);\n\n    const resume = () => {\n      if (!interval.current) {\n        timer();\n      }\n    };\n\n    const stop = () => {\n      if (onEnd) {\n        onEnd(currentSeconds.current);\n      }\n\n      init();\n      clear();\n    };\n\n    useEffect(() => {\n      init();\n    }, [initialSeconds]);\n\n    useEffect(() => {\n      return () => {\n        pause();\n      };\n    }, []);\n\n    useEffect(() => {\n      if (autoStart) {\n        start();\n      }\n    }, [autoStart]);\n\n    const timer = useCallback(() => {\n      interval.current = BackgroundTimer.setInterval(() => {\n        if (currentSeconds.current > 0) {\n          currentSeconds.current = currentSeconds.current - 1;\n          hours.current = ~~(currentSeconds.current / 3600);\n          minute.current = ~~((currentSeconds.current % 3600) / 60);\n          seconds.current = ~~currentSeconds.current % 60;\n\n          if (onTimes) {\n            onTimes(currentSeconds.current);\n          }\n        }\n        if (currentSeconds.current <= 0) {\n          if (onEnd) {\n            onEnd(currentSeconds.current);\n          }\n          clear();\n        }\n        setKey(Math.random());\n      }, 1000);\n    }, []);\n\n    const start = useCallback(() => {\n      init();\n\n      if (!interval.current) {\n        timer();\n      }\n    }, []);\n\n    const clear = () => {\n      if (interval.current) {\n        BackgroundTimer.clearInterval(interval.current);\n        interval.current = 0;\n      }\n    };\n\n    const font = () => {\n      if (fontFamily) {\n        return {\n          fontFamily: fontFamily,\n        };\n      } else {\n        return {};\n      }\n    };\n\n    const renderTimer = () => {\n      if (formatTime === 'hh:mm:ss') {\n        if (hours.current > 0) {\n          return (\n            <Text style={[styles.text, textStyle, font()]}>{`${hours.current}:${\n              minute.current.toString().length === 1 ? '0' : ''\n            }${minute.current}:${\n              seconds.current.toString().length === 1 ? '0' : ''\n            }${seconds.current}`}</Text>\n          );\n        } else {\n          if (minute.current > 0) {\n            return (\n              <Text style={[styles.text, textStyle, font()]}>{`${\n                minute.current\n              }:${seconds.current.toString().length === 1 ? '0' : ''}${\n                seconds.current\n              }`}</Text>\n            );\n          } else {\n            return (\n              <Text\n                style={[styles.text, textStyle, font()]}\n              >{`${seconds.current}`}</Text>\n            );\n          }\n        }\n      } else {\n        return (\n          <Text\n            style={[styles.text, textStyle, font()]}\n          >{`${currentSeconds.current}`}</Text>\n        );\n      }\n    };\n\n    return (\n      <View style={style} key={key}>\n        {renderTimer()}\n      </View>\n    );\n  }\n);\n\nCountdownComponent.defaultProps = defaultProps;\n\nexport default CountdownComponent;\n"],"mappings":"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"}